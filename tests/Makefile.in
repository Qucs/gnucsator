include ../Make2

QUCSATOR = qucsator
GNUCSATOR = ${srcdir}/../gnucsator.sh
GNUCAP = gnucap$(SUFFIX)

DIFF = diff -w -u
NUMDIFF = numdiff -r1.e-6 -a1.e-8
REF = ref

SHELL = /bin/bash
LN_S = ln -s

all: gc qucs

include ${srcdir}/Make1

check: diff

diff: \
	$(COMMON_TESTS:%=%.v.diff) \
	$(GC_TESTS:%=%.diff) \
	$(COMMON_TESTS:%=%.gc.diff)

gc: $(GC_TESTS:%.gc=%.gc.out) \
    $(COMMON_TESTS:%.net=%.net.gc.out)

$(COMMON_TESTS:%.net=%.net.gc.out): qucs
$(GC_TESTS:%.net=%.gc.out): qucs
$(COMMON_TESTS:%.net=%.net.v.out): qucs

${LINKS}: ${PWD}/%:
	-${LN_S} ${srcdir}/$*

qucs: ${LINKS}
	[ -e qucs ] || ${LN_S} .. qucs

$(COMMON_TESTS:%=%.gc.out) $(COMMON_TESTS:%=%.v.out) $(GC_TESTS:%=%.out): .P

.PHONY: .P check diff

.P:
	@:

clean:
	rm -rf ${CLEANFILES}

CLEANFILES = *.out *.dc *.diff *.tr *.sp

include ${srcdir}/Make3
